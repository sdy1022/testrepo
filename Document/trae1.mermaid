graph TD
    subgraph Program Flow
        A[Start Application] --> B[Configure Serilog]
        B --> C[Initialize SPService]
        C --> D[SPDailyETSACCheck]
        C --> E[RDDSAPProcess]
        C --> F[TempBOMTest]
    end

    subgraph SPDailyETSACCheck Process
        D --> G[Get ETSAC Daily List]
        G --> H[Process Each Query]
        H --> I[Call AS400 API]
        I --> J{Check Response}
        J -->|Success| K[Log Status Change]
    end

    subgraph RDDSAPProcess Flow
        E --> L[Get Unprocessed SAP Data]
        L --> M[Create Add/Del Pairs]
        M --> N[Call SAP API]
        N --> O[Process Response]
        O --> P[Create SAP Files]
        P --> Q[Update Status]
    end

    subgraph SPService Operations
        R[Process AS400] --> S{Success?}
        S -->|Yes| T[Process SAP]
        S -->|No| U[Rollback AS400]
        
        T --> V{SAP Success?}
        V -->|Yes| W[Process SQL]
        V -->|No| X[Rollback SAP/AS400]
        
        W --> Y[Move to Production]
        Y --> Z[Send Notifications]
    end

    style A fill:#98FB98
    style Z fill:#98FB98
    style U fill:#FFB6C1
    style X fill:#FFB6C1